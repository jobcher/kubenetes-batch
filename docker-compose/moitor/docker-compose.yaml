version: '3'
services:
    prometheus:
        image: prom/prometheus
        container_name: prometheus
        hostname: prometheus
        restart: always
        volumes:
            - ./prometheus.yml:/etc/prometheus/prometheus.yml
            - ./file_sd:/etc/prometheus/file_sd
        network_mode: host

    alertmanager:  #预警模块
        image: prom/alertmanager
        container_name: alertmanager
        hostname: alertmanager
        restart: always
        network_mode: host

    grafana:
        image: grafana/grafana
        container_name: grafana
        hostname: grafana
        restart: always
        network_mode: host

    #node
    node_exporter:
      image: prom/node-exporter:v1.3.1
      container_name: node_exporter
      command:
        - '--path.rootfs=/host'
      network_mode: host
      pid: host
      restart: unless-stopped
      volumes:
        - '/:/host:ro,rslave'

#snmp
    snmp-exporter:
      image: prom/snmp-exporter
      container_name: snmp_exporter
      restart: unless-stopped
      volumes:
        - ./snmp_exporter/:/etc/snmp_exporter/
        - ./snmp_exporter/snmp.yml:/etc/snmp_exporter/snmp.yml
      ports:
        - 9116:9116
      command:
        - "--config.file=/etc/snmp_exporter/snmp.yml"